---
title: DNS
order: 5
---

# DNS

DNS 协议建立在 UDP 或 TCP 协议之上，默认使用 53 号端口。客户端 **默认通过 UDP 协议进行通讯**，但是由于广域网中不适合传输过大的 UDP 数据包，因此规定当报文长度超过了 512 字节时，转换为使用 TCP 协议进行数据传输。

![image.png](https://i.loli.net/2020/09/11/fjZzO59r4YxoiUA.png)

首先明确，**DNS 的作用就是通过域名查询到具体的 IP**。

## 域名

因为 IP 存在数字和英文的组合（IPv6），很不利于人类记忆，所以就出现了域名。你可以把域名看成是某个 IP 的别名，DNS 就是去查询这个别名的真正名称是什么。当你在浏览器地址栏输入 URL 时，第一件事就是做 DNS 查询，按查询方式可以分为：迭代查询和递归查询。

## 迭代查询（Iterative Query）

![image.png](https://i.loli.net/2020/09/11/fEOUSRTkCbWJcF2.png)

我们以访问 `www.domain.com` 为例，使用迭代查询时，会进行以下操作，

- 操作系统会首先在本地缓存中查询
- 没有的话会去系统配置的 DNS 服务器中查询
- 如果还没有，会直接去 DNS 根服务器查询，这一步查询会找出负责 com 这个一级域名的服务器
- 然后去该服务器查询 google 这个二级域名
- 接下来三级域名的查询其实是我们配置的，你可以给 www 这个域名配置一个 IP，然后还可以给别的三级域名配置一个 IP

## 递归查询（Recursive Query）

主机向本地域名服务器的查询一般都是采用递归查询，与迭代查询的区别是，递归查询是由系统配置的 DNS 服务器做请求，得到结果后将数据返回给客户端。也就是说，递归查询时不会告诉 “你下一步应当向哪一个域名服务器进行查询”，它的结果 **要么是所要查询的 IP 地址，要么就报错**。
